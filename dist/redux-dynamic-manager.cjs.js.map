{"version":3,"file":"redux-dynamic-manager.cjs.js","sources":["../node_modules/@babel/runtime/helpers/defineProperty.js","../src/index.js"],"sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","import React from 'react';\nimport { combineReducers } from 'redux';\nimport { useDispatch } from 'react-redux';\nimport global from 'global';\n\nexport const createReducerManager = (initialReducers) => {\n  const reducers = { ...initialReducers };\n\n  let combinedReducer = combineReducers(reducers);\n  let keysToRemove = [];\n\n  return {\n    reduce(state, action) {\n      if (keysToRemove.length > 0) {\n        state = { ...state };\n\n        for (const key of keysToRemove) {\n          delete state[key];\n        }\n\n        keysToRemove = [];\n      }\n\n      return combinedReducer(state, action);\n    },\n    add(key, reducer) {\n      if (!key || reducers[key]) return;\n      reducers[key] = reducer;\n      combinedReducer = combineReducers(reducers);\n    },\n    remove(key) {\n      if (!key || !reducers[key]) return;\n      delete reducers[key];\n      keysToRemove.push(key);\n      combinedReducer = combineReducers(reducers);\n    },\n\n  };\n};\n\nexport const bindReducerManager = reducerManager => {\n  global.reducerManager = reducerManager;\n};\n\nexport const dynamic = (key, reducer) => WrappedComponent => {\n  if (typeof key === 'string') {\n    global.reducerManager.add(key, reducer);\n  }\n\n  if (Array.isArray(key)) {\n    if (key.length === 2) {\n      global.reducerManager.add(key[0], combineReducers({ [key[1]]: reducer }));\n    }\n\n    if (key.length === 3) {\n      global.reducerManager.add(\n        key[0],\n        combineReducers({\n          [key[1]]: combineReducers({ [key[2]]: reducer }),\n        }),\n      );\n    }\n  }\n\n  const Dynamic = (props) => {\n    const dispatch = useDispatch();\n    dispatch({ type: '@@redux/INIT' });\n    return <WrappedComponent {...props} />;\n  };\n\n  return Dynamic;\n};\n"],"names":["createReducerManager","initialReducers","reducers","combinedReducer","combineReducers","keysToRemove","reduce","state","action","length","key","add","reducer","remove","push","bindReducerManager","reducerManager","global","dynamic","WrappedComponent","Array","isArray","Dynamic","props","dispatch","useDispatch","type"],"mappings":";;;;;;;;;;;AAAA,SAAS,eAAe,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE;EACxC,IAAI,GAAG,IAAI,GAAG,EAAE;IACd,MAAM,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE;MAC9B,KAAK,EAAE,KAAK;MACZ,UAAU,EAAE,IAAI;MAChB,YAAY,EAAE,IAAI;MAClB,QAAQ,EAAE,IAAI;KACf,CAAC,CAAC;GACJ,MAAM;IACL,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;GAClB;;EAED,OAAO,GAAG,CAAC;CACZ;;AAED,kBAAc,GAAG,eAAe;;;;;ICVnBA,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,eAAD,EAAqB;MACjDC,QAAQ,qBAAQD,eAAR,CAAd;;MAEIE,eAAe,GAAGC,qBAAe,CAACF,QAAD,CAArC;MACIG,YAAY,GAAG,EAAnB;SAEO;IACLC,MADK,kBACEC,KADF,EACSC,MADT,EACiB;UAChBH,YAAY,CAACI,MAAb,GAAsB,CAA1B,EAA6B;QAC3BF,KAAK,qBAAQA,KAAR,CAAL;;;;;;+BAEkBF,YAAlB,8HAAgC;gBAArBK,GAAqB;mBACvBH,KAAK,CAACG,GAAD,CAAZ;;;;;;;;;;;;;;;;;QAGFL,YAAY,GAAG,EAAf;;;aAGKF,eAAe,CAACI,KAAD,EAAQC,MAAR,CAAtB;KAZG;IAcLG,GAdK,eAcDD,GAdC,EAcIE,OAdJ,EAca;UACZ,CAACF,GAAD,IAAQR,QAAQ,CAACQ,GAAD,CAApB,EAA2B;MAC3BR,QAAQ,CAACQ,GAAD,CAAR,GAAgBE,OAAhB;MACAT,eAAe,GAAGC,qBAAe,CAACF,QAAD,CAAjC;KAjBG;IAmBLW,MAnBK,kBAmBEH,GAnBF,EAmBO;UACN,CAACA,GAAD,IAAQ,CAACR,QAAQ,CAACQ,GAAD,CAArB,EAA4B;aACrBR,QAAQ,CAACQ,GAAD,CAAf;MACAL,YAAY,CAACS,IAAb,CAAkBJ,GAAlB;MACAP,eAAe,GAAGC,qBAAe,CAACF,QAAD,CAAjC;;GAvBJ;CANK;AAmCP,IAAaa,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,cAAc,EAAI;EAClDC,MAAM,CAACD,cAAP,GAAwBA,cAAxB;CADK;AAIP,IAAaE,OAAO,GAAG,SAAVA,OAAU,CAACR,GAAD,EAAME,OAAN;SAAkB,UAAAO,gBAAgB,EAAI;QACvD,OAAOT,GAAP,KAAe,QAAnB,EAA6B;MAC3BO,MAAM,CAACD,cAAP,CAAsBL,GAAtB,CAA0BD,GAA1B,EAA+BE,OAA/B;;;QAGEQ,KAAK,CAACC,OAAN,CAAcX,GAAd,CAAJ,EAAwB;UAClBA,GAAG,CAACD,MAAJ,KAAe,CAAnB,EAAsB;QACpBQ,MAAM,CAACD,cAAP,CAAsBL,GAAtB,CAA0BD,GAAG,CAAC,CAAD,CAA7B,EAAkCN,qBAAe,oBAAIM,GAAG,CAAC,CAAD,CAAP,EAAaE,OAAb,EAAjD;;;UAGEF,GAAG,CAACD,MAAJ,KAAe,CAAnB,EAAsB;QACpBQ,MAAM,CAACD,cAAP,CAAsBL,GAAtB,CACED,GAAG,CAAC,CAAD,CADL,EAEEN,qBAAe,oBACZM,GAAG,CAAC,CAAD,CADS,EACHN,qBAAe,oBAAIM,GAAG,CAAC,CAAD,CAAP,EAAaE,OAAb,EADZ,EAFjB;;;;QASEU,OAAO,GAAG,SAAVA,OAAU,CAACC,KAAD,EAAW;UACnBC,QAAQ,GAAGC,sBAAW,EAA5B;MACAD,QAAQ,CAAC;QAAEE,IAAI,EAAE;OAAT,CAAR;aACO,oBAAC,gBAAD,EAAsBH,KAAtB,CAAP;KAHF;;WAMOD,OAAP;GA1BqB;CAAhB;;;;;;"}